---
title: Extreme Gradient Boosting Algorithm
author: andrea perlato
date: '2019-03-13'
slug: extreme-gradient-boosting-algorithm
categories:
  - machine learning
tags:
  - XGBoost
---

<style>
body {
text-align: justify}
</style>

Extreme Gradient Boosting is extensively used because is fast and accurate, and can handle missing values. </br>
Gradient boosting is a machine learning technique for regression and classification problems, which produces a prediction model in the form of an ensemble of weak prediction models, typically decision trees. It builds the model in a stage-wise fashion like other boosting methods do, and it generalizes them by allowing optimization of an arbitrary differentiable loss function. </br>
XGBoost is one of the implementations of Gradient Boosting concept, but what makes XGBoost unique is that it uses  a more regularized model formalization to control over-fitting, which gives it better performance. </br>

We use it in an example to predict, based on some features (e.g. the rank of the school student come from), if a student is admited or rejected. 

```{r, echo=FALSE, comment=NA, message=FALSE, warning=FALSE}
library(xgboost)
library(magrittr)
library(dplyr)
library(Matrix)
data <- read.csv("C:/07 - R Website/dataset/ML/binary.csv")
data$rank <- as.factor(data$rank)
```

```{r, echo=TRUE, comment=NA, message=FALSE, warning=FALSE}
# Partition Data
set.seed(1234)
ind <- sample(2, nrow(data), replace = T, prob = c(0.8, 0.2))
train <- data[ind==1,]
test <- data[ind==2,]

# Create matrix One-Hot Encoding for Factor variables.
# One-Hot Encoding convert our data in a numeric format, as required by XGBoost.
# It convert the variable rank in a sparse matrix, in order to have dummy variable for each rank.
trainm <- sparse.model.matrix(admit ~ .-1, data = train) 
head(trainm)

# Convert Train-Set in a Matrix
train_label <- train[,"admit"] # define the responce variable
train_matrix <- xgb.DMatrix(data = as.matrix(trainm), label = train_label)

```

From the matrix above, we can see that One-Hot Encoding was made for the factor variabile (i.e. rank).
We repeat the same procedure for the Test-set.

```{r, echo=TRUE, comment=NA, message=FALSE, warning=FALSE}
# Convert Test-Set in a Matrix
testm <- sparse.model.matrix(admit ~ .-1, data = test) 
test_label <- test[,"admit"] # define the responce variable
test_matrix <- xgb.DMatrix(data = as.matrix(testm), label = test_label)

```

For now, we have the matrix formatted in the proper format needed for the analysis.










